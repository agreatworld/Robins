# 模块
* 背包
* 商店
* 随机事件
* 地图
* 主角属性
* 游戏机制
* 存读档

## 背包

遵循MVP架构设计

### model层

数据结构：Dictionary<选项卡, List<卡片>>
选项卡采取枚举类型。

卡片作为一个类或结构体，成员变量包含但不限于：
* int型的ID（便于对同一类的卡片进行排序，从左到右从上到下依次递增）
* string名字
* bool变量是否已拥有
* int变量该卡片拥有的数量（0则表示未拥有）

注：
1. 考虑到卡片需要频繁地进行赋值操作，设定为类。
2. 对外不采取通过数量为0来判定是否拥有，规范使用bool变量进行判定，在内部可通过数量来改变bool值。

附加一个只保存已拥有卡牌的字典用于显示“已拥有卡牌”，这个字典中包含已拥有但是数量为0的卡牌。对外开放刷新方法。

### view层

背包界面有三个选项卡，选中显示不同种类的卡片，即种子、种子肥料、鸟的饲料。

鼠标悬浮时显示蒙版。

获取已拥有的卡片数量，在已拥有的卡片旁边显示数量。
已拥有但是数量为0的卡牌不变灰，只显示数量为0。
每个选项卡的panel要保存每张卡片的Rect Transform坐标，这是为“选择只看已拥有的卡片”打基础。可采取
Dictionary<卡片, 坐标>。对字典进行排序，使其按照从左至右从上至下（可更改）的顺序排列。

### presenter层

设定为单例。

背包面板设定为一个panel，设计最顶层的背包管理类，用于管理数据的可视化和更新。

抽象出界面刷新的方法，该方法可能在多处调用，甚至在其他脚本中也需要调用。需要调用的地方包含但不限
于：
1. 打开背包界面（默认打开第一个选项卡）
2. 点击选项卡处于非激活状态的选项卡，已激活的就不再刷新

刷新方法的实现逻辑：
1. 判定当前需要显示的选项卡
2. 获取选项卡类型的卡片数据
3. 显示选项卡对应的panel（每个选项卡对应一个panel），并隐藏未被选中的选项卡对应界面。

可选择只看已拥有的卡牌，实现思路为隐藏未拥有的卡片，将已拥有的卡片按照ID依次排列，坐标可以从view层中获取，通过在已拥有的卡片中的id位次来定位到新的位置（例如：在已拥有中ID第三大的卡片可定位到所有卡片中ID第三大的卡片位置），取消选择此选项时则可以直接通过先前保存的位置还原。选中时，所有选项卡均显示已拥有的卡牌。

除了与model、view双向通信，这个顶级类还应该存储一些辅助信息：
当前背包界面处于显示状态的选项卡（用来控制被选中的选项卡的表现）
（待完善）

## 商店

每回合开始时自动弹出，可使用羽毛选择需要购买的物品，也可以通过商店按钮打开界面。

商店可加入刷新功能。

### 与其他模块的通信

购买时需要访问羽毛数量，背包数据。

这个模块比较单独，目前只涉及与背包的通信。

## 随机事件

额外的画面表现和对数值的影响，对其他模块的依赖比较低。

## 地图

地图为一整块，有可视区域。

滚动鼠标可缩放地图。

地图有预先设定的可播种区域，鼠标悬浮勾勒出区域轮廓。

播种区域具体的植物摆放位置暂不讨论。

## 主角属性

行动次数和背包。

## 游戏机制

### 回合设定

4个季节 * 4个回合 = 16个回合

### 行动次数

初始为3，通过使用羽毛来提升。

### 回合开始
1. 自动补满行动次数
2. 现有的鸟产出羽毛，表现为羽毛悬浮在鸟附近，可以依次点击拾取，也可点击一键拾取按钮。未被拾取的羽毛会在回合结束时自动响应一键拾取。羽毛只有一种样式，每个位置产出的羽毛只有数量不同，暴露一个羽毛数量属性，可通过tag获取。
3. 逐一判定播出的种子是否培育成功，成功的单位要表现出来，最终呈现出特定树种。
4. 季节特定气候变化。暂不定论。
5. 商店物品刷新，或自动弹出商店界面。
6. 根据规则出剧情动画过场。